<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
	xmlns:ora="http://www.liquibase.org/xml/ns/dbchangelog-ext" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.2.xsd
                   http://www.liquibase.org/xml/ns/dbchangelog-ext view-source:http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd">


	<!-- This is an example file to show the name pattern -->


	<changeSet id="setup-001" author="mv">
		<createTable tableName="users">
			<column name="id" type="bigint">
				<constraints primaryKey="true" nullable="false" />
			</column>
			<column name="login" type="varchar(32)">
				<constraints nullable="false" />
			</column>
			<column name="password" type="varchar(255)">
				<constraints nullable="true" />
			</column>
		</createTable>
	</changeSet>


	<changeSet id="setup-002" author="mv">
		<createTable tableName="jobs">
			<column name="id" type="bigint">
				<constraints primaryKey="true" nullable="false" />
			</column>
			<column name="name" type="varchar(32)">
				<constraints nullable="false" />
			</column>
			<column name="description" type="text">
				<constraints nullable="true" />
			</column>
			<column name="userid" type="bigint">
				<constraints nullable="false" />
			</column>
		</createTable>

		<addForeignKeyConstraint baseColumnNames="userid"
			baseTableName="jobs" constraintName="fk_user_job"
			deferrable="true" initiallyDeferred="true" onDelete="CASCADE"
			onUpdate="RESTRICT" referencedColumnNames="id" referencedTableName="users" />
	</changeSet>
	
	
	<changeSet id="setup-003" author="mv">
		<createTable tableName="work">
			<column name="id" type="bigint">
				<constraints primaryKey="true" nullable="false" />
			</column>
			<column name="start" type="bigint">
				<constraints nullable="false" />
			</column>
			<column name="end" type="bigint">
				<constraints nullable="true" />
			</column>
			<column name="jobid" type="bigint">
				<constraints nullable="false" />
			</column>
		</createTable>
		<addForeignKeyConstraint baseColumnNames="jobid"
			baseTableName="work" constraintName="fk_work_job"
			deferrable="true" initiallyDeferred="true" onDelete="CASCADE"
			onUpdate="RESTRICT" referencedColumnNames="id" referencedTableName="jobs" />
	</changeSet>

	<changeSet id="setup-004" author="mv">
		    <addColumn tableName="job">
		    	<column name="activeworkid" type="bigint"/>
		    </addColumn>
	</changeSet>



</databaseChangeLog>